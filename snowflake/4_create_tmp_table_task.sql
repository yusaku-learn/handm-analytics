--タスクの作成
create or replace task create_temp_customer
warehouse = COMPUTE_WH

SCHEDULE = 'USING CRON 00 17 * * * Asia/Tokyo'

as
CREATE OR REPLACE TABLE HANDM.PUBLIC.temp_customer_table(
customer_id string,
FN int,
active int,
club_mebmer_status string,
fashion_news_frequency string,
age int,
postal_code string
);

ALTER TASK create_temp_customer RESUME;

-- temp_articleテーブルを作成

CREATE OR REPLACE task create_temp_articles_table
warehouse = COMPUTE_WH
SCHEDULE = 'USING CRON 00 17 * * * Asia/Tokyo'
as
create or replace TABLE HANDM.PUBLIC.temp_ARTICLES (
	ARTICLE_ID NUMBER(38,0),
	PRODUCT_CODE NUMBER(38,0),
	PROD_NAME VARCHAR(16777216),
	PRODUCT_TYPE_NO NUMBER(38,0),
	PRODUCT_TYPE_NAME VARCHAR(16777216),
	PRODUCT_GROUP_NAME VARCHAR(16777216),
	GRAPHICAL_APPEARANCE_NO VARCHAR(16777216),
	GRAPHICAL_APPEARANCE_NAME VARCHAR(16777216),
	COLOUR_GROUP_CODE NUMBER(38,0),
	COLOUR_GROUP_NAME VARCHAR(16777216),
	PERCEIVED_COLOUR_VALUE_ID NUMBER(38,0),
	PERCEIVED_COLOUR_VALUE_NAME VARCHAR(16777216),
	PERCEIVED_COLOUR_MASTER_ID NUMBER(38,0),
	PERCEIVED_COLOUR_MASTER_NAME VARCHAR(16777216),
	DEPARTMENT_NO NUMBER(38,0),
	DEPARTMENT_NAME VARCHAR(16777216),
	INDEX_CODE VARCHAR(16777216),
	INDEX_NAME VARCHAR(16777216),
	INDEX_GROUP_NO NUMBER(38,0),
	INDEX_GROUP_NAME VARCHAR(16777216),
	SECTION_NO NUMBER(38,0),
	SECTION_NAME VARCHAR(16777216),
	GARMENT_GROUP_NO NUMBER(38,0),
	GARMENT_GROUP_NAME VARCHAR(16777216),
	DETAIL_DESC VARCHAR(16777216)
);







CREATE OR REPLACE TABLE HANDM.PUBLIC.temp_customer_table(
customer_id string,
FN int,
active int,
club_mebmer_status string,
fashion_news_frequency string,
age int,
postal_code string
);

create or replace TABLE HANDM.PUBLIC.temp_ARTICLES (
	ARTICLE_ID NUMBER(38,0),
	PRODUCT_CODE NUMBER(38,0),
	PROD_NAME VARCHAR(16777216),
	PRODUCT_TYPE_NO NUMBER(38,0),
	PRODUCT_TYPE_NAME VARCHAR(16777216),
	PRODUCT_GROUP_NAME VARCHAR(16777216),
	GRAPHICAL_APPEARANCE_NO VARCHAR(16777216),
	GRAPHICAL_APPEARANCE_NAME VARCHAR(16777216),
	COLOUR_GROUP_CODE NUMBER(38,0),
	COLOUR_GROUP_NAME VARCHAR(16777216),
	PERCEIVED_COLOUR_VALUE_ID NUMBER(38,0),
	PERCEIVED_COLOUR_VALUE_NAME VARCHAR(16777216),
	PERCEIVED_COLOUR_MASTER_ID NUMBER(38,0),
	PERCEIVED_COLOUR_MASTER_NAME VARCHAR(16777216),
	DEPARTMENT_NO NUMBER(38,0),
	DEPARTMENT_NAME VARCHAR(16777216),
	INDEX_CODE VARCHAR(16777216),
	INDEX_NAME VARCHAR(16777216),
	INDEX_GROUP_NO NUMBER(38,0),
	INDEX_GROUP_NAME VARCHAR(16777216),
	SECTION_NO NUMBER(38,0),
	SECTION_NAME VARCHAR(16777216),
	GARMENT_GROUP_NO NUMBER(38,0),
	GARMENT_GROUP_NAME VARCHAR(16777216),
	DETAIL_DESC VARCHAR(16777216)
);